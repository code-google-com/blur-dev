#summary Shows how to register a COM interface to execute scripts from external editors
#labels Autodesk,3dsMax,Python,Tutorial

*Thanks to Thorsten Kaufmann for this tutorial!*

 * You need to get pywin32 to get COM functionality.  These can be found online for whichever version of python you'll need (the link for Python26 x64 is [http://sourceforge.net/projects/pywin32/files/pywin32/Build%20214/pywin32-214.win-amd64-py2.6.exe/download here]. 
 * Next, we need a maxscript function to execute our script.  It needs to be available via com hence we need to register it.  Here is an example:
{{{
fn exec_py script = (
   if ( python != undefined ) then ( python.run( script ) )
   else ( print "ERROR: BlurPython DLL is not loaded" )
)
registerOLEInterface #(exec_py)
}}}
 place it in a .ms file and place this in your scripts/startup folder so it gets registered on max startup
 * We need to connect to max from the outside world and trigger the function.  Cause this is all about python, I decided to do that in python too as a command line script.  See below the code for notes:
{{{
import win32com.client
import sys
       
#Create a connection to Max
conn = win32com.client.Dispatch("MAX.Application.2008")
       
#Flag as a Method otherwise python or win32com will most likely treat it as attribute.
conn._FlagAsMethod("exec_py")
     
conn.exec_py(sys.argv[1])
}}}
 You need to tweak "MAX.Application.2008" to match your version. What it does is connect to a running max instance or start a new one if none is available and call the ole function we registered before with the first commandline argument as a function argument.

 To test this you can run it from the commandline:

 {{{ python execute.py "scriptpath_and_filename" }}}

If all went well max should run your python script triggered by the commandline. Neato

Now i went to my editor (for testing i used komodo edit) and added a custom run commando that looks like this:
 {{{ c:\python26_64\python c:\blur\execute.py %F }}}

%F is the placeholder for the currently edited script. So hitting the shortcut for that one executes the script in max. Now why do we do that ? Cause i dig the additional editing functions (esp things like intellisense and autocomplete...and yay...they work with the blur modules as far as i can tell)

Hope this helps someone,

Thorsten
